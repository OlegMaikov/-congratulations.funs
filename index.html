<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <title>–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∫–Ω–∏–≥</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <link rel="stylesheet" href="./styles.css" />
  <script type="importmap">
  {
    "imports": {
      "nanoid": "https://esm.sh/nanoid@5",
      "jszip": "https://esm.sh/jszip@3.10.0"
    }
  }
  </script>
</head>
<body>
  <!-- splash removed: app opens directly to editor -->

  <div class="app-root" aria-hidden="false">
    <header class="top-bar">
      <div class="book-meta" role="region" aria-label="–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∫–Ω–∏–≥–∏">
        <input id="book-title-input" class="book-title-input" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–Ω–∏–≥–∏" aria-label="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–Ω–∏–≥–∏" data-i18n="bookTitlePlaceholder" />
        <input id="book-author-input" class="book-author-input" placeholder="–ê–≤—Ç–æ—Ä" aria-label="–ê–≤—Ç–æ—Ä" data-i18n="bookAuthorPlaceholder" />
      </div>
      <div style="margin-left:12px;display:flex;gap:8px;align-items:center;">
        <div class="lang-switch">
          <label for="lang-select" class="lang-label">Lang</label>
          <select id="lang-select" aria-label="Language switch">
            <option value="ru">RU</option>
            <option value="en">EN</option>
          </select>
        </div>
      </div>
    </header>

    <nav class="tabs">
      <button class="tab-btn active" data-tab="editor" data-i18n="tabEditor">–†–µ–¥–∞–∫—Ç–æ—Ä</button>
      <button class="tab-btn" data-tab="structure" data-i18n="tabStructure">–°—Ç—Ä—É–∫—Ç—É—Ä–∞</button>
      <button class="tab-btn" data-tab="cover" data-i18n="tabCover">–û–±–ª–æ–∂–∫–∞</button>
      <button class="tab-btn" data-tab="preview" data-i18n="tabPreview">–ü—Ä–æ—Å–º–æ—Ç—Ä</button>
      <button id="help-open-btn" class="tab-btn" style="margin-left:auto;" data-i18n="helpButton">‚ùî –ü–æ–º–æ—â—å</button>
    </nav>

    <main class="tab-views">
      <section class="tab-view active" data-tab="editor">
        <div class="tab-instruction" data-i18n="editorInstruction">üí° –í—ã–±–µ—Ä–∏—Ç–µ –≥–ª–∞–≤—É, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –¥–æ–±–∞–≤–ª—è–π—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è. –®—Ä–∏—Ñ—Ç—ã –∏ —Ä–∞–∑–º–µ—Ä ‚Äî —Å–ø—Ä–∞–≤–∞.</div>
        <div class="editor-header">
          <select id="chapter-select" class="chapter-select" aria-label="–í—ã–±—Ä–∞—Ç—å –≥–ª–∞–≤—É"></select>
          <div class="chapter-actions">
            <button id="add-chapter-btn" class="pill-btn" data-i18n="addChapter">+ –ì–ª–∞–≤–∞</button>
            <button id="delete-chapter-btn" class="pill-btn pill-btn--danger" data-i18n="deleteChapter">–£–¥–∞–ª–∏—Ç—å</button>
          </div>
        </div>
        <div class="editor-toolbar" id="editor-toolbar">
          <button data-cmd="bold" title="–ñ–∏—Ä–Ω—ã–π (Ctrl+B)"><strong>B</strong></button>
          <button data-cmd="italic" title="–ö—É—Ä—Å–∏–≤ (Ctrl+I)"><em>I</em></button>
          <button data-cmd="underline" title="–ü–æ–¥—á—ë—Ä–∫–∏–≤–∞–Ω–∏–µ (Ctrl+U)"><span class="u">U</span></button>
          <button data-cmd="strikeThrough" title="–ó–∞—á—ë—Ä–∫–Ω—É—Ç—ã–π">SÃ∂</button>
          <button data-cmd="insertUnorderedList">‚Ä¢ –°–ø–∏—Å–æ–∫</button>
          <button data-cmd="insertOrderedList">1. –°–ø–∏—Å–æ–∫</button>
          <button data-cmd="formatBlock" data-value="h1">H1</button>
          <button data-cmd="formatBlock" data-value="h2">H2</button>
          <button data-cmd="formatBlock" data-value="h3">H3</button>
          <button data-cmd="formatBlock" data-value="blockquote" title="–¶–∏—Ç–∞—Ç–∞">‚ùù</button>
          <button data-cmd="formatBlock" data-value="p">P</button>
          <button data-cmd="insertHorizontalRule" title="–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è">‚îÄ</button>
          <button data-cmd="createLink" title="–í—Å—Ç–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É">üîó</button>
          <button data-cmd="unlink" title="–£–¥–∞–ª–∏—Ç—å —Å—Å—ã–ª–∫—É">‚õìÔ∏è</button>
          <button id="voice-btn" class="voice-btn" title="–î–∏–∫—Ç–æ–≤–∫–∞" data-i18n-title="voiceBtnTitle">üé§</button>
          <button id="insert-image-btn" title="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ" data-i18n-title="insertImage">üñºÔ∏è</button>
          <input id="insert-image-input" type="file" accept="image/*" style="display:none" />
          <button data-cmd="undo" title="–û—Ç–º–µ–Ω–∏—Ç—å (Ctrl+Z)">‚Ü∂</button>
          <button data-cmd="redo" title="–ü–æ–≤—Ç–æ—Ä–∏—Ç—å (Ctrl+Y)">‚Ü∑</button>
          <button data-cmd="removeFormat" title="–û—á–∏—Å—Ç–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ">Tx</button>
          <div class="align-controls">
            <button class="align-btn" data-cmd="justifyLeft" title="–í–ª–µ–≤–æ">‚üµ</button>
            <button class="align-btn" data-cmd="justifyCenter" title="–¶–µ–Ω—Ç—Ä">‚üÇ</button>
            <button class="align-btn" data-cmd="justifyRight" title="–í–ø—Ä–∞–≤–æ">‚ü∂</button>
          </div>
          <div id="editor-stats" class="editor-stats" title="–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–µ–∫—Å—Ç–∞"><span id="word-count">0 —Å–ª</span> ¬∑ <span id="char-count">0 –∑–Ω</span></div>
          <label class="font-control" title="–®—Ä–∏—Ñ—Ç">
            <select id="font-family-select">
              <option value="serif">Serif</option>
              <option value="sans-serif">Sans</option>
              <option value="monospace">Mono</option>
            </select>
          </label>
          <label class="font-control" title="–†–∞–∑–º–µ—Ä">
            <select id="font-size-select">
              <option value="14px">14px</option>
              <option value="15px" selected>15px</option>
              <option value="16px">16px</option>
              <option value="18px">18px</option>
              <option value="20px">20px</option>
            </select>
          </label>
        </div>
        <div id="editor" class="editor" contenteditable="true"></div>
      </section>

      <section class="tab-view" data-tab="structure">
        <div class="tab-instruction" data-i18n="structureInstruction">üìã –£–ø—Ä–∞–≤–ª—è–π—Ç–µ –≥–ª–∞–≤–∞–º–∏: –ø–µ—Ä–µ—É–ø–æ—Ä—è–¥–æ—á–∏–≤–∞–π—Ç–µ, –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–π—Ç–µ –∏ —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ –Ω–æ–≤—ã–µ.</div>
        <div class="structure-list" id="structure-list"></div>
        <button id="structure-add-chapter-btn" class="full-width-btn">+ –î–æ–±–∞–≤–∏—Ç—å –≥–ª–∞–≤—É</button>
      </section>

      <section class="tab-view" data-tab="cover">
        <div class="tab-instruction" data-i18n="coverInstruction">üé® –û—Ñ–æ—Ä–º–∏—Ç–µ –æ–±–ª–æ–∂–∫—É: –≤—ã–±–µ—Ä–∏—Ç–µ —Ü–≤–µ—Ç, –∑–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –¥–æ–±–∞–≤—å—Ç–µ –ø–æ–¥–∑–∞–≥–æ–ª–æ–≤–æ–∫.</div>
        <div class="cover-layout">
          <div class="cover-controls" id="cover-controls">
            <label class="field">
              <span data-i18n="subtitleLabel">–ü–æ–¥–∑–∞–≥–æ–ª–æ–≤–æ–∫</span>
              <input id="subtitle-input" />
            </label>
            <label class="field">
              <span data-i18n="coverColorLabel">–¶–≤–µ—Ç —Ñ–æ–Ω–∞</span>
              <div class="color-row">
                <input id="cover-color-input" type="color" value="#6366f1" />
                <select id="cover-theme-select">
                  <option value="classic">–ö–ª–∞—Å—Å–∏–∫–∞</option>
                  <option value="dark">–¢—ë–º–Ω–∞—è</option>
                  <option value="fairy">–°–∫–∞–∑–∫–∞</option>
                </select>
              </div>
            </label>
            <label class="field">
              <span data-i18n="uploadCoverLabel">–ó–∞–≥—Ä—É–∑–∏—Ç—å –æ–±–ª–æ–∂–∫—É</span>
              <input id="cover-image-input" type="file" accept="image/*" />
              <button id="cover-image-clear" class="pill-btn" type="button" data-i18n="clearCover">–û—á–∏—Å—Ç–∏—Ç—å</button>
            </label>
            <label class="field">
              <span data-i18n="subtitleColorLabel">–¶–≤–µ—Ç –ø–æ–¥–∑–∞–≥–æ–ª–æ–≤–∫–∞</span>
              <input id="subtitle-color-input" type="color" value="#ffffff" />
            </label>
          </div>

          <!-- Added compact action row to avoid overlap and keep controls in flow -->
          <div class="cover-actions-row">
            <button id="cover-controls-toggle" class="pill-btn cover-controls-toggle" data-i18n="hideSettings">–°–∫—Ä—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
            <button id="cover-show-preview" class="pill-btn" data-i18n="showInPreview">–ü–æ–∫–∞–∑–∞—Ç—å –≤ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–µ</button>
            <button id="cover-download-btn" class="pill-btn" type="button">–°–∫–∞—á–∞—Ç—å –æ–±–ª–æ–∂–∫—É</button>
          </div>

          <div class="cover-preview" id="cover-preview" title="–ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã –∑–∞–≥—Ä—É–∑–∏—Ç—å">
            <div class="cover-inner">
              <div class="cover-title" id="cover-title"></div>
              <div class="cover-subtitle" id="cover-subtitle"></div>
              <div class="cover-author" id="cover-author"></div>
            </div>
            <div class="cover-hint">–ù–∞–∂–º–∏—Ç–µ –æ–±–ª–æ–∂–∫—É</div>
          </div>
        </div>
      </section>

      <section class="tab-view" data-tab="preview">
        <div class="tab-instruction" data-i18n="previewInstruction">üëÅÔ∏è –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –∫–Ω–∏–≥—É –ø–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω–æ –∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –≤ –Ω—É–∂–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç.</div>
        <div class="preview-pane">
          <div class="preview-controls">
            <button id="prev-page-btn" class="icon-pill">‚Üê</button>
            <div id="page-indicator" class="page-indicator">–°—Ç—Ä. 1 / 1</div>
            <button id="next-page-btn" class="icon-pill">‚Üí</button>
            <div class="orientation-toggle">
              <label><input type="radio" name="orientation" value="portrait" id="orient-portrait" checked /><span>–ü</span></label>
              <label><input type="radio" name="orientation" value="landscape" id="orient-landscape" /><span>–õ</span></label>
            </div>
          </div>
          <div class="preview-scroll" id="preview-frame">
            <div class="preview-page" id="preview-page"></div>
          </div>
          <div id="page-thumbs" class="page-thumbs"></div>
          <div class="export-row">
            <button class="pill-btn" data-format="epub" data-i18n="expEPUB">EPUB</button>
            <button class="pill-btn" data-format="fb2" data-i18n="expFB2">FB2</button>
            <button class="pill-btn" data-format="html" data-i18n="expHTML">HTML</button>
            <button class="pill-btn" data-format="docx" data-i18n="expDOCX">DOCX</button>
          </div>
        </div>
      </section>
    </main>
  </div>

  <div id="editor-help-modal" class="help-modal" role="dialog" aria-hidden="true" aria-label="–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä—É">
    <div class="help-card">
      <div class="help-header">
        <strong id="help-title">–ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ä–µ–¥–∞–∫—Ç–æ—Ä–æ–º ‚Äî —à–∞–≥ –∑–∞ —à–∞–≥–æ–º</strong>
        <button id="help-close-btn" class="icon-btn" title="–ó–∞–∫—Ä—ã—Ç—å">‚úï</button>
      </div>
      <ol class="help-steps" id="help-steps"></ol>
      <div class="help-actions">
        <button id="help-gotit-btn" class="pill-btn" data-i18n="helpGotIt">–ü–æ–Ω—è—Ç–Ω–æ</button>
      </div>
    </div>
  </div>

  <!-- Learn more modal shown from splash "–£–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ" -->
  <div id="splash-learn-modal" class="help-modal" role="dialog" aria-hidden="true" aria-label="–ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ">
    <div class="help-card">
      <div class="help-header">
        <strong id="learn-title" data-i18n="learnTitle">–ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ –∫–Ω–∏–≥</strong>
        <button id="learn-close-btn" class="icon-btn" title="–ó–∞–∫—Ä—ã—Ç—å" data-i18n-title="splashCloseTitle">‚úï</button>
      </div>
      <div class="help-steps" id="learn-body" style="padding-left:0; color:var(--text-secondary); line-height:1.6;">
        <p data-i18n="learnP1"><strong>–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∫–Ω–∏–≥–∏:</strong> –ú–æ–¥—É–ª—å–Ω—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä, —É–¥–æ–±–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã –æ–±–ª–æ–∂–µ–∫ –∏ —ç–∫—Å–ø–æ—Ä—Ç –≤ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã.</p>
        <p data-i18n="learnP2"><strong>–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç:</strong> –°–æ–∑–¥–∞–π—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ, –¥–æ–±–∞–≤—å—Ç–µ –≥–ª–∞–≤—ã, –≤—Å—Ç–∞–≤–ª—è–π—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥.</p>
        <p data-i18n="learnP3"><strong>–ì–∏–±–∫–∞—è –æ–±–ª–æ–∂–∫–∞:</strong> –¶–≤–µ—Ç–∞, —Ç–µ–º—ã, –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã –æ–±–ª–æ–∂–∫–∏.</p>
        <p data-i18n="learnP4" style="margin-top:8px;color:var(--text-secondary);font-size:13px;">–ù–∞–∂–º–∏—Ç–µ "–ù–∞—á–∞—Ç—å" –Ω–∞ –∑–∞—Å—Ç–∞–≤–∫–µ, —á—Ç–æ–±—ã –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Ä–µ–¥–∞–∫—Ç–æ—Ä—É, –∏–ª–∏ –∑–∞–∫—Ä–æ–π—Ç–µ —ç—Ç–æ –æ–∫–Ω–æ.</p>
      </div>
      <div class="help-actions">
        <button id="learn-gotit-btn" class="pill-btn" data-i18n="learnGotIt">–ü–æ–Ω—è—Ç–Ω–æ</button>
      </div>
    </div>
  </div>

  <script type="module" src="./main.js"></script>
</body>
</html>